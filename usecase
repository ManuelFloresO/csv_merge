### **Nota en GitHub: Resumen del Script de Combinaci√≥n de Archivos CSV**

---

#### **üìå Resumen del Script**

Este script en PowerShell est√° dise√±ado para combinar m√∫ltiples archivos CSV en un solo archivo maestro, optimizando el uso de memoria y garantizando que los encabezados no se dupliquen. Es ideal para tareas de auditor√≠a, consolidaci√≥n de datos y procesamiento de archivos grandes. A continuaci√≥n, se detallan los elementos clave del script:

---

#### **üî¢ Entradas de Datos**

El script requiere las siguientes entradas:
1. **Carpeta de origen (`$sourceFolder`)**:
   - Ruta de la carpeta que contiene los archivos CSV que se desean combinar.
   - Ejemplo: `C:\Users\itanf\checkpassCSV`.

2. **Archivos CSV**:
   - Archivos con extensi√≥n `.csv` ubicados en la carpeta de origen.
   - Cada archivo debe tener una estructura consistente, incluyendo una l√≠nea de fecha y una l√≠nea de encabezados.

3. **Archivo de salida (`$outputFile`)**:
   - Ruta y nombre del archivo CSV combinado.
   - Ejemplo: `C:\Users\itanf\checkpassCSV\master_password_audit.csv`.

---

#### **üîÑ Transformaci√≥n de Datos**

El script procesa los archivos CSV de la siguiente manera:
1. **Lectura de archivos**:
   - Usa `StreamReader` para leer cada archivo l√≠nea por l√≠nea, optimizando el uso de memoria.

2. **Manejo de encabezados**:
   - Solo el primer archivo incluye sus encabezados en el archivo combinado.
   - Los archivos subsiguientes omiten las dos primeras l√≠neas (fecha y encabezados).

3. **Escritura del archivo combinado**:
   - Usa `StreamWriter` para escribir el contenido en el archivo de salida.
   - Garantiza que los recursos se liberen correctamente mediante un bloque `try/finally`.

---

#### **üéØ Resultado Final**

Tras la ejecuci√≥n del script, se obtiene:
- **Un archivo CSV combinado**:
  - Contiene los datos de todos los archivos CSV de entrada.
  - Mantiene los encabezados √∫nicos del primer archivo.
  - Omite las l√≠neas de fecha y encabezados de los archivos subsiguientes.

- **Mensaje de confirmaci√≥n**:
  - Se muestra en la consola la ruta del archivo combinado.
  - Ejemplo: `Archivos combinados en: C:\Users\itanf\checkpassCSV\master_password_audit.csv`.

---

#### **üìä Diagrama de Flujo de Datos**

```plaintext
+-------------------+       +-------------------+       +-------------------+
|  Carpeta de Origen |       |  Procesamiento    |       |  Archivo Combinado |
|  (Archivos CSV)    | ----> |  (StreamReader/   | ----> |  (master_password_ |
|                   |       |  StreamWriter)    |       |  audit.csv)        |
+-------------------+       +-------------------+       +-------------------+
```

1. **Entrada**: Archivos CSV en la carpeta de origen.
2. **Procesamiento**:
   - Lectura l√≠nea por l√≠nea.
   - Manejo de encabezados.
   - Escritura en el archivo combinado.
3. **Salida**: Archivo CSV combinado con datos consolidados.

---

#### **üìÇ Caso de Uso Pr√°ctico**

**Contexto**:
Un equipo de auditor√≠a necesita consolidar m√∫ltiples informes de contrase√±as en un solo archivo para su an√°lisis. Cada informe es un archivo CSV con la siguiente estructura:
- L√≠nea 1: Fecha de ejecuci√≥n.
- L√≠nea 2: Encabezados.
- L√≠neas siguientes: Datos de auditor√≠a.

**Problema**:
Los informes est√°n dispersos en m√∫ltiples archivos CSV, y combinarlos manualmente es tedioso y propenso a errores.

**Soluci√≥n**:
El script automatiza la combinaci√≥n de los archivos CSV, generando un archivo maestro con los datos consolidados y encabezados √∫nicos.

**Ejemplo**:
- **Archivo1.csv**:
  ```
  # Fecha de Ejecuci√≥n: 2025-02-24 23:21:37
  Cliente,Servidor,Fecha de Ejecuci√≥n,Usuario,D√≠as √öltimo Cambio,Fecha √öltimo Cambio,Tipo Cuenta,Requiere Cambio,Fortaleza,Estado,Informe
  KIO,redhat-vm,24/02/2025 23:21,nobody,819,28/11/2022,Local,S√≠,Cumple,rojo,ALERTA: Contrase√±a expirada (819 d√≠as).
  ```

- **Archivo2.csv**:
  ```
  # Fecha de Ejecuci√≥n: 2025-02-24 23:21:37
  Cliente,Servidor,Fecha de Ejecuci√≥n,Usuario,D√≠as √öltimo Cambio,Fecha √öltimo Cambio,Tipo Cuenta,Requiere Cambio,Fortaleza,Estado,Informe
  KIO,redhat-vm,24/02/2025 23:21,itan_flores,32,23/01/2025,Local,S√≠,Cumple,rojo,ALERTA: Contrase√±a expirada (32 d√≠as).
  ```

- **Archivo combinado (`master_password_audit.csv`)**:
  ```
  # Fecha de Ejecuci√≥n: 2025-02-24 23:21:37
  Cliente,Servidor,Fecha de Ejecuci√≥n,Usuario,D√≠as √öltimo Cambio,Fecha √öltimo Cambio,Tipo Cuenta,Requiere Cambio,Fortaleza,Estado,Informe
  KIO,redhat-vm,24/02/2025 23:21,nobody,819,28/11/2022,Local,S√≠,Cumple,rojo,ALERTA: Contrase√±a expirada (819 d√≠as).
  KIO,redhat-vm,24/02/2025 23:21,itan_flores,32,23/01/2025,Local,S√≠,Cumple,rojo,ALERTA: Contrase√±a expirada (32 d√≠as).
  ```

---

#### **‚úÖ Beneficios del Script**

- **Automatizaci√≥n**: Elimina la necesidad de combinar archivos manualmente.
- **Eficiencia**: Procesa archivos grandes sin consumir mucha memoria.
- **Consistencia**: Garantiza que los encabezados no se dupliquen.
- **Facilidad de uso**: Solo requiere configurar las rutas de entrada y salida.

---

Este resumen proporciona una visi√≥n clara y concisa del funcionamiento del script, su aplicaci√≥n pr√°ctica y los beneficios que ofrece. ¬°Espero que sea √∫til para tu repositorio en GitHub! üòä
